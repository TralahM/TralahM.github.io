I"š%<h2 id="lagrange-interpolation">Lagrange Interpolation</h2>
<h3 id="mathematical-background">Mathematical Background</h3>
<p>This technique is useful for un-equspaced data points and if youâ€™ve taken a
course in Numerical Analysis you probably are familiar with this technique among
other interpolation methods like the</p>
<ul>
  <li><em>Netwonâ€™s Forward Difference Interpolating Polynomial</em>  and</li>
  <li><em>Netwonâ€™s Backward Difference Interpolating Polynomial</em></li>
</ul>

<p>It allows us to find values of unseen data points based on existing data,value pairs</p>

<p>From the definition of gradient, we take three points <script type="math/tex">(x,f(x)), (x_{0},f(x_{0})) ,  (x_{1},f(x_{1}))</script></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">x</th>
      <th style="text-align: center"><script type="math/tex">x_{0}</script></th>
      <th style="text-align: center"><script type="math/tex">x_{1}</script></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><script type="math/tex">f(x)</script></td>
      <td style="text-align: center"><script type="math/tex">f(x_{0})</script></td>
      <td style="text-align: center"><script type="math/tex">f(x_{1})</script></td>
    </tr>
  </tbody>
</table>

<p><em>To find the gradient of a function we use</em>,</p>

<script type="math/tex; mode=display">\frac{ \delta y}{ \delta x} = \frac{f(x) - f(x_{0})}{x - x_{0}} = \frac{f(x_{0}) - f(x_{1})}{x_{0} - x_{1}}</script>

<p>Let us solve for <script type="math/tex">f(x)</script>.</p>

<h3 id="solution">Solution</h3>
<p>By cross multiplication we have,</p>

<script type="math/tex; mode=display">(f(x) - f(x_{0}))(x_{0} - x_{1}) = (f(x_{0}) - f(x_{1}))(x - x_{0})</script>

<p>Expanding the Multiplication on both sides,</p>

<script type="math/tex; mode=display">x_{0}f(x) - x_{0}f(x_{0}) - x_{1}f(x) + x_{1}f(x_{0})  = xf(x_{0}) - xf(x_{1}) - x_{0}f(x_{0}) + x_{0}f(x_{1})</script>

<p>Removing the common term <script type="math/tex">x_{0}f(x_{0})</script> from both sides we have:</p>

<script type="math/tex; mode=display">x_{0}f(x) - x_{1}f(x) + x_{1}f(x_{0})  = xf(x_{0}) - xf(x_{1}) + x_{0}f(x_{1})</script>

<p>Grouping terms of <script type="math/tex">f(x)</script> on one side we have:</p>

<script type="math/tex; mode=display">x_{0}f(x) - x_{1}f(x)  = xf(x_{0}) - xf(x_{1}) + x_{0}f(x_{1}) - x_{1}f(x_{0})</script>

<p>Reducing the equation to</p>

<script type="math/tex; mode=display">(x_{0} - x_{1})f(x) =  (x - x_{1})f(x_{0}) + (x_{0} - x)f(x_{1})</script>

<p>solving for <script type="math/tex">f(x)</script> by dividing both sides by <script type="math/tex">(x_{0} - x_{1})</script> we obtain:</p>

<p><script type="math/tex">f(x) =  \frac{(x - x_{1})f(x_{0}) + (x_{0} - x)f(x_{1})}{x_{0} - x_{1}}</script> or</p>

<script type="math/tex; mode=display">f(x) =  \frac{x - x_{1}}{x_{0} - x_{1}}f(x_{0}) +\frac{x_{0} - x}{x_{0} - x_{1}}f(x_{1})</script>

<h2 id="example">Example</h2>

<h3 id="writing-a-python-script-to-solve-this-problem">Writing a Python Script to Solve this problem.</h3>

<p>I wrote a program in python that takes <script type="math/tex">x_{0},x_{1},x,f(x_{0}) and f(x_{1})</script> values and returns the result, <script type="math/tex">f(x)</script>
after performing lagrange interpolation using the data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!python
#lagrange.py x0, x1, f(x0), f(x1) X
</span><span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">ArgumentParser</span>

<span class="k">def</span> <span class="nf">foX</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">f_x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">f_x1</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">x0_x1</span><span class="o">=</span><span class="n">x0</span><span class="o">-</span><span class="n">x1</span>
    <span class="n">x0_X</span><span class="o">=</span><span class="n">x0</span><span class="o">-</span><span class="n">X</span>
    <span class="n">X_x1</span><span class="o">=</span><span class="n">X</span><span class="o">-</span><span class="n">x1</span>
    <span class="n">f_x1</span><span class="o">=</span><span class="n">f_x1</span>
    <span class="n">f_x0</span><span class="o">=</span><span class="n">f_x0</span>
    <span class="n">f_X</span><span class="o">=</span><span class="p">(</span> <span class="p">(</span><span class="n">x0_X</span><span class="o">*</span><span class="n">f_x1</span><span class="p">)</span><span class="o">/</span><span class="n">x0_x1</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span><span class="n">X_x1</span><span class="o">*</span><span class="n">f_x0</span><span class="p">)</span><span class="o">/</span><span class="n">x0_x1</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">f_X</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">parser</span><span class="o">=</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-x0'</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s">'store'</span><span class="p">,</span><span class="n">dest</span><span class="o">=</span><span class="s">'x0'</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">"X0 value"</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-x1'</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s">'store'</span><span class="p">,</span><span class="n">dest</span><span class="o">=</span><span class="s">'x1'</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">"X1 value"</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-f_x0'</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s">'store'</span><span class="p">,</span><span class="n">dest</span><span class="o">=</span><span class="s">'f_x0'</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">"f_X0 value"</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-f_x1'</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s">'store'</span><span class="p">,</span><span class="n">dest</span><span class="o">=</span><span class="s">'f_x1'</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">"f_X1 value"</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-X'</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s">'store'</span><span class="p">,</span><span class="n">dest</span><span class="o">=</span><span class="s">'X'</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">"X value to interpolate"</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">args</span><span class="o">=</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"f(</span><span class="si">%</span><span class="s">f) is </span><span class="si">%</span><span class="s">f"</span><span class="o">%</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">foX</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">args</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span><span class="n">args</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span><span class="n">args</span><span class="o">.</span><span class="n">f_x0</span><span class="p">,</span><span class="n">args</span><span class="o">.</span><span class="n">f_x1</span><span class="p">)))</span>
</code></pre></div></div>
:ET